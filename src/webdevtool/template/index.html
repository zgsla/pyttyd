<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="css/xterm.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/xterm.js"></script>
    <script src="js/xterm-addon-fit.js"></script>
</head>
<body>
    <div class="container">
      <h1>Terminal</h1>
      <div id="terminal"></div>
    </div>
    


</body>
<script type="module">
    const term = new Terminal({
      cursorStyle:'underline',  //光标样式
      cursorBlink:true,  //光标闪烁
    });
    const fitAddon = new FitAddon.FitAddon();
    term.loadAddon(fitAddon);
    fitAddon.fit();
    term.focus();
    term.open(document.getElementById('terminal'));

    var ws = new WebSocket("ws://localhost:8001"); 
    //申请一个WebSocket对象，参数是服务端地址，同http协议使用http://开头一样，WebSocket协议的url使用ws://开头，另外安全的WebSocket协议使用wss://开头
    ws.onopen = function(){
      //当WebSocket创建成功时，触发onopen事件
      console.log("open");
    }
    ws.onmessage = function(e){
      //当客户端收到服务端发来的消息时，触发onmessage事件，参数e.data包含server传递过来的数据
      console.log(e.data);
      term.write(e.data);
      
    }
    ws.onclose = function(e){
      //当客户端收到服务端发送的关闭连接请求时，触发onclose事件
      console.log("close");
    }
    ws.onerror = function(e){
      //如果出现连接、处理、接收、发送数据失败的时候触发onerror事件
      console.log(error);
    }

    term.onData(function(i){
      console.log(i);
      ws.send(JSON.stringify({"input": i}))
    });
    

</script>
</html>